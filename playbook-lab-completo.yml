---
- name: "Fase 1: Configurar el Servidor FOG (AlmaLinux)"
  hosts: almalinux_control_node
  become: true
  roles:
    - role: common
    - role: manage_users
    - role: security_hardening
    - role: manage_maintenance
    # - role: manage_storage  # Descomenta cuando puedas a√±adir el disco
    # - role: install_fog

- name: "Fase 2: Configurar Clientes del Game Center (Windows)"
  hosts: windows_clients_gamecenter
  become: false
  
  pre_tasks:
    - name: "Verificar conectividad WinRM con los clientes"
      ansible.windows.win_ping:
      tags: [always]

  roles:
    - role: configure_windows_clients

- name: "Fase 3: Configurar Clientes del Laboratorio (Linux Mint)"
  hosts: linux_clients_academic
  become: true # 'apt' requiere sudo
  
  pre_tasks:
    - name: "Verificar conectividad SSH con los clientes"
      ansible.builtin.ping:
      tags: [always]

  roles:
    - role: configure_linux_clients